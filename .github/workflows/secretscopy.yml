name: Sync Secrets 22

on:
  push:
    branches:
      - main  # Or specify the branch you want to trigger this workflow

jobs:
  sync-secrets:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout source code
        uses: actions/checkout@v2

      - name: Sync Secrets
        run: |
            sudo apt install python3
            sudo apt install python3-pip
            sudo pip install pynacl
            python3 file.py
            cat output.txt
            var=$(cat output.txt)
            echo "$var"
            curl --location --request PUT 'https://api.github.com/repos/neeratikrishna15/databricksencryption/actions/secrets/TOKEN' --header 'Authorization: Bearer ${{ secrets.TOKEN }}' --header 'Content-Type: application/json' --data-raw '{"encrypted_value":$var,"key_id":"3380204578043523366"}'
            curl --location --request GET 'https://api.github.com/repos/neeratikrishna15/databricksencryption/actions/secrets' --header 'Authorization: Bearer ${{ secrets.TOKEN }}'
