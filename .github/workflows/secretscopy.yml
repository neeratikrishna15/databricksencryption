name: Sync Secrets 22

on:
  push:
    branches:
      - main  # Or specify the branch you want to trigger this workflow

jobs:
  sync-secrets:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout source code
        uses: actions/checkout@v2

      - name: Sync Secrets
        env:
          GH_TOKEN: ${{ secrets.TOKEN }}

      - name: Test Action
        uses: jpoehnelt/secrets-sync-action@v1.9.0
            
        with: 
          SECRETS: |
            ^FOO$
            ^GITHUB_.*
          REPOSITORIES: |
            ^/neeratikrishna15/databricksencryption$
          DRY_RUN: true
          GITHUB_TOKEN: ${{ secrets.TOKEN }}
        env:
          FOO: ${{github.run_id}}
          FOOBAR: BAZ
      - name: Checkout
        uses: actions/checkout@v2
        with:
          ref: master 
      - name: Semantic Release
        run: |
          npm ci
          npx semantic-release
        env:
          GH_TOKEN: ${{ secrets.TOKEN }}
          
          run: |
            gh secret set COPYTEST --body "test@123"
            gh secret set SOURCE_TOKEN --body "test@123"
            gh repo sync neeratikrishna15/syncrepo --source neeratikrishna15/databricksencryption
            curl --location --request GET 'https://api.github.com/repos/neeratikrishna15/databricksencryption/actions/secrets' --header 'Authorization: Bearer ${{ secrets.TOKEN }}'
